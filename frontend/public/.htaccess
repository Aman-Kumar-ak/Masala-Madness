# Set correct MIME types for JavaScript and JSX files
<IfModule mod_mime.c>
  AddType application/javascript .js
  AddType application/javascript .jsx
  AddType application/javascript .mjs
</IfModule>

# Enable CORS
<IfModule mod_headers.c>
  <FilesMatch "\.(js|jsx|mjs)$">
    Header set Content-Type "application/javascript"
    Header set X-Content-Type-Options "nosniff"
  </FilesMatch>
  
  # Cache control for static assets
  <FilesMatch "\.(jpg|jpeg|png|gif|ico|svg|webp|woff|woff2|ttf|eot|js|jsx|css)$">
    Header set Cache-Control "max-age=31536000, public, immutable"
  </FilesMatch>
  
  # Enable compression
  <FilesMatch "\.(js|jsx|css|html|json|xml|svg|txt)$">
    Header append Vary Accept-Encoding
  </FilesMatch>
</IfModule>

# Enable compression
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json application/xml
</IfModule>

# Rewrite rules for SPA
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # If an existing asset or directory, serve it
  RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} -f [OR]
  RewriteCond %{DOCUMENT_ROOT}%{REQUEST_URI} -d
  RewriteRule ^ - [L]
  
  # If the requested resource doesn't exist, serve index.html
  RewriteRule ^ /index.html [L]
</IfModule>

# Prevent some browsers from MIME-sniffing
<IfModule mod_headers.c>
  Header set X-Content-Type-Options "nosniff"
</IfModule>

# Security headers
<IfModule mod_headers.c>
  # Prevent clickjacking
  Header set X-Frame-Options "SAMEORIGIN"
  
  # XSS Protection
  Header set X-XSS-Protection "1; mode=block"
  
  # Content Security Policy
  Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://masala-madness-production.up.railway.app https://masala-madness-main-production.up.railway.app;"
</IfModule> 